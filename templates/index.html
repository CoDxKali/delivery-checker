<!DOCTYPE html>
<html>
<head>
    <title>Delivery Checker</title>

    <style>
        body {
            font-family: Arial;
            background:#f5f5f5;
            display:flex;
            justify-content:center;
            align-items:center;
            height:100vh;
        }
        .card {
            background:white;
            padding:30px;
            border-radius:10px;
            box-shadow:0 0 10px #ddd;
            width:350px;
            text-align:center;
        }

        #pincode {
            padding:12px;
            width:90%;
            margin:10px 0;
            border-radius:8px;
            border:2px solid #ddd;
            outline:none;
            transition:0.3s;
        }

        #pincode.valid { border-color:#28a745; }
        #pincode.invalid { border-color:#dc3545; }

        .result { margin-top:15px; font-weight:bold; }

        .loader {
    display:none;
    margin:10px auto;
    border:4px solid #f3f3f3;
    border-top:4px solid #000;
    border-radius:50%;
    width:22px;
    height:22px;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
    </style>
</head>
<body>

<div class="card">
    <h2>Check 3hrs Xpress Delivery Availability</h2>

    <input type="text"
           id="pincode"
           placeholder="Enter your pincode"
           oninput="debounceCheck()" />

    <div id="result" class="result"></div>
</div>

<script>
let debounceTimer;

function debounceCheck() {
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(checkDelivery, 600);
}

function checkDelivery() {
    const pincodeInput = document.getElementById("pincode");
    const pincode = pincodeInput.value.trim();

    if (pincode.length < 6) {
        pincodeInput.classList.remove("valid", "invalid");
        document.getElementById("result").innerHTML = "";
        return;
    }

    fetch("/check-delivery", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({pincode: pincode})
    })
    .then(res => res.json())
    .then(data => {
        if (data.error) {
            pincodeInput.classList.remove("valid");
            pincodeInput.classList.add("invalid");
            document.getElementById("result").innerHTML = "Invalid pincode";
            return;
        }

        const isAvailable = data.available;

        if (isAvailable) {
            pincodeInput.classList.add("valid");
            pincodeInput.classList.remove("invalid");
        } else {
            pincodeInput.classList.add("invalid");
            pincodeInput.classList.remove("valid");
        }

        const statusText = isAvailable
            ? "âœ… Delivery Available"
            : "ðŸšš Standard Delivery";

        document.getElementById("result").innerHTML =
            `${statusText}<br>${data.city}, ${data.state}`;
    });
}
</script>

</body>
</html>